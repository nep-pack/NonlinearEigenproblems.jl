<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial 12 (Orr–Somerfeld) · NEP-PACK</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">NEP-PACK</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../methods/">NEP-Solvers</a></li><li><a class="tocitem" href="../types/">Types &amp; Data structures</a></li><li><a class="tocitem" href="../compute_functions/">Compute functions</a></li><li><a class="tocitem" href="../linsolvers/">Linear solvers</a></li><li><a class="tocitem" href="../innersolvers/">Projection</a></li><li><a class="tocitem" href="../errmeasure/">Measuring the error</a></li><li><a class="tocitem" href="../logger/">Logger</a></li><li><a class="tocitem" href="../transformations/">Transformations</a></li><li><a class="tocitem" href="../deflation/">Deflation</a></li><li><a class="tocitem" href="../gallery/">Gallery</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../movebc_tutorial/">Tutorial 1 (ABC)</a></li><li><a class="tocitem" href="../tutorial_contour/">Tutorial 2 (Contour)</a></li><li><a class="tocitem" href="../bemtutorial/">Tutorial 3 (BEM)</a></li><li><a class="tocitem" href="../deflate_tutorial/">Tutorial 4 (Deflation)</a></li><li><a class="tocitem" href="../tutorial_call_python/">Tutorial 5 (Python 1)</a></li><li><a class="tocitem" href="../tutorial_python_call/">Tutorial 6 (Python 2)</a></li><li><a class="tocitem" href="../tutorial_matlab1/">Tutorial 7 (MATLAB)</a></li><li><a class="tocitem" href="../tutorial_fortran1/">Tutorial 8 (FORTRAN)</a></li><li><a class="tocitem" href="../tutorial_nano1/">Tutorial 9 (gmsh + nanophotonics)</a></li><li><a class="tocitem" href="../tutorial_newmethod/">Tutorial 10 (New solver)</a></li><li><a class="tocitem" href="../tutorial_linsolve/">Tutorial 11 (Linear solvers)</a></li><li class="is-active"><a class="tocitem" href>Tutorial 12 (Orr–Somerfeld)</a><ul class="internal"><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li><a class="tocitem" href="#Formulation-as-a-nonlinear-eigenvalue-problem"><span>Formulation as a nonlinear eigenvalue problem</span></a></li><li><a class="tocitem" href="#Problem-setup-in-NEP-PACK"><span>Problem setup in NEP-PACK</span></a></li><li><a class="tocitem" href="#Solving-with-NEP-PACK"><span>Solving with NEP-PACK</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Tutorial 12 (Orr–Somerfeld)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial 12 (Orr–Somerfeld)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/nep-pack/NonlinearEigenproblems.jl/blob/master/docs/src/hydrotutorial.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial:-Stability-of-parallel-shear-flows"><a class="docs-heading-anchor" href="#Tutorial:-Stability-of-parallel-shear-flows">Tutorial: Stability of parallel shear flows</a><a id="Tutorial:-Stability-of-parallel-shear-flows-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial:-Stability-of-parallel-shear-flows" title="Permalink"></a></h1><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>Stability analysis of flows is a very important problem in fluid mechanics.  Linearizing the <a href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations">Navier–Stokes equations</a> around the mean flow and then eliminating pressure gives us the Orr–Sommerfeld and Squire equations, which are a system of fourth order PDEs describing the dynamics:</p><p class="math-container">\[\left(\Big(\dfrac{\partial }{\partial t}+U\dfrac{\partial }{\partial x}\Big)\nabla^2-U&#39;&#39;\dfrac{\partial }{\partial x}-\frac{1}{Re}\nabla^4\right)v = 0\\
\left(\dfrac{\partial }{\partial t}+U\dfrac{\partial }{\partial x}-\frac{1}{Re}\nabla^2\right)\eta = -U&#39;&#39;\dfrac{\partial v}{\partial z}.\]</p><p>More precisely, these equations stem from modeling using a mean base laminar flow <span>$\overline{U} = \begin{pmatrix}U(y)&amp; 0&amp; 0\end{pmatrix}$</span> and the perturbation <span>$u&#39; = \begin{pmatrix}u&amp; v&amp; w\end{pmatrix}$</span>. The normal vorticity is denoted <span>$\eta$</span>.</p><p>This is a text-book model for fluid flows. The model is often used to study stability by making a plane wave ansatz and a transformation, and subsequently rewriting the discretized problem as a large standard eigenvalue problem, see <a href="https://www.springer.com/gp/book/9780387989853#aboutBook">Chapter 7, Stability and Transition in Shear Flows, Schmid, Peter J., Henningson, Dan S</a>. We will here show that the plane wave ansatz directly leads to a NEP, which can be solved with methods in NEP-PACK without any additional transformations. We reproduce computational results in the above reference.</p><p>We thank Miguel Beneitez and Prabal Negi, Department of Mechanics, KTH for the valuable discussions and the discretization code.</p><h2 id="Formulation-as-a-nonlinear-eigenvalue-problem"><a class="docs-heading-anchor" href="#Formulation-as-a-nonlinear-eigenvalue-problem">Formulation as a nonlinear eigenvalue problem</a><a id="Formulation-as-a-nonlinear-eigenvalue-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Formulation-as-a-nonlinear-eigenvalue-problem" title="Permalink"></a></h2><p>To study stability we use the plane wave perturbations ansatz</p><p class="math-container">\[v(x,y,z,t) = \tilde{v}(y)\exp(i(\alpha x+\beta z-\omega t))\\
\eta(x,y,z,t) = \tilde{\eta}(y)\exp(i(\alpha x+\beta z-\omega t)),\]</p><p>which transforms the system to</p><p class="math-container">\[\left((-i\omega+i\alpha U)(\mathcal{D}^2-\alpha^2-\beta^2)-i\alpha U&#39;&#39;-\frac{1}{Re}(\mathcal{D}^2-\alpha^2-\beta^2)^2\right)\tilde{v} = 0,\\
\left((-i\omega+i\alpha U)-\frac{1}{Re}(\mathcal{D}^2-\alpha^2-\beta^2)\right)\eta = -i\beta U&#39;\tilde{v},\]</p><p>where <span>$\mathcal{D}$</span> denotes the 1-D differential operator <span>$\frac{\partial }{\partial y}$</span>. In this example, we consider the boundary conditions <span>$\tilde{v} = \mathcal{D}\tilde{v} = \tilde{\eta} = 0$</span>. We assume that <span>$\beta$</span> and <span>$\omega$</span> are given and we wish to solve for the eigenvalue <span>$\alpha\in\mathbb{C}$</span>.</p><p>This is usually done by using a transformation of the form</p><p class="math-container">\[\begin{pmatrix}\tilde{v}\\ \tilde{\eta}\end{pmatrix} = \begin{pmatrix}\tilde{V}\\ \tilde{E}\end{pmatrix}\exp(-\alpha y)\]</p><p>which reduces the power of <span>$\alpha$</span> from four to two. The problem is then discretized and solved as a quadratic eigenvalue problem. See Chapter 7 in Schmid–Henningson for details.  </p><p>Rather than using the transformation approach described in the book of Schmid–Henningson, we simply discretize <span>$\mathcal{D}$</span> to <span>$D$</span> (using a suitable numerical discretization) which leads to a polynomial eigenvalue problem of fourth order.</p><p>We define diagonal matrices <span>$U_0$</span>, <span>$U_1$</span> and <span>$U_2$</span>  as follows</p><p class="math-container">\[U_0 = diag(U(y_0),U(y_1),\ldots,U(y_n)),\\
U_1 = diag(U&#39;(y_0),U&#39;(y_1),\ldots,U&#39;(y_n)),\\
U_2 = diag(U&#39;&#39;(y_0),U&#39;&#39;(y_1),\ldots,U&#39;&#39;(y_n)),\]</p><p>where <span>$\{y_i\}_{i=1,\ldots,n}$</span> denotes the y-coordinates of the <span>$n$</span> grid points used for discretization. The discretized problem, after expanding the powers, gives</p><p class="math-container">\[\left[-\frac{I}{Re}\alpha^4-iU_0\alpha^3+\left(\frac{2D^2}{Re}+\left(i\omega-
\frac{2\beta^2}{Re}\right)I\right)\alpha^2\right.+\\
\left.\left(iU_0(D^2-\beta^2I)-U_2\right)\alpha +\Big(\frac{2\beta^2D^2}{Re}-\frac{D^4}{Re}-\frac{\beta^4I}{Re}+i\omega(\beta^2I-D^2)\Big)\right]\tilde{v} = 0\\
i\beta U_1\tilde{v}+\left[\frac{I}{Re}\alpha^2 + iU_0 \alpha +\left(\left(\frac{\beta^2}{Re}-i\omega\right)I-\frac{D^2}{Re}\right)\right]\tilde{\eta} = 0.\]</p><p>This can be be formulated as a polynomial eigenvalue problem</p><p class="math-container">\[M(\lambda) = A_0+A_1\lambda+A_2\lambda^2+A_3\lambda^3+A_4\lambda^4,\]</p><p>and the matrices <span>$A_0,\ldots,A_4$</span> are given by</p><p class="math-container">\[A_0 = \begin{pmatrix}\frac{2\beta^2D^2}{Re}-\frac{D^4}{Re}-\frac{\beta^4I}{Re}+i\omega(\beta^2I-D^2)&amp; 0\\ i\beta U_1&amp;\left(\frac{\beta^2}{Re}-i\omega\right)I-\frac{D^2}{Re}\end{pmatrix}\\
A_1 = \begin{pmatrix}iU_0(D^2-\beta^2I)-U_2&amp; 0\\0&amp; iU_0\end{pmatrix}\\
A_2 = \begin{pmatrix}\frac{2D^2}{Re}+\left(i\omega-
\frac{2\beta^2}{Re}\right)I&amp; 0\\0&amp; \frac{I}{Re}\end{pmatrix}\\
A_3 = \begin{pmatrix}-iU_0&amp; 0\\0&amp; 0\end{pmatrix}\\
A_4 = \begin{pmatrix}-\frac{I}{Re}&amp; 0\\0&amp; 0\end{pmatrix}.\]</p><p>The eigenvector is given by <span>$\begin{pmatrix}\tilde{v}^T &amp; \tilde{\eta}\end{pmatrix}^T$</span></p><h2 id="Problem-setup-in-NEP-PACK"><a class="docs-heading-anchor" href="#Problem-setup-in-NEP-PACK">Problem setup in NEP-PACK</a><a id="Problem-setup-in-NEP-PACK-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-setup-in-NEP-PACK" title="Permalink"></a></h2><p>The tutorial uses the helper-functions <code>chebdif</code> and <code>cheb4c</code>, which are provided in <a href="https://nep-pack.github.io/NonlinearEigenproblems.jl/cheb4c.jl">cheb4c.jl</a> and <a href="https://nep-pack.github.io/NonlinearEigenproblems.jl/chebdif.jl">chebdif.jl</a>.</p><pre><code class="language-julia hljs">using NonlinearEigenproblems, Plots, ToeplitzMatrices;
include(&quot;cheb4c.jl&quot;);
include(&quot;chebdif.jl&quot;);</code></pre><p>We begin by initializing the parameters to the values used to generate the data in Table 7.1 in Schmid–Henningson.</p><pre><code class="language-julia-repl hljs">N = 256;      # Number of interior points
Re = 2000;    # Reynolds number
ω  = 0.3;     # Input frequency
β  = 0.0;     # Spanwise wavenumber</code></pre><p>To set up the matrices <span>$A_i$</span>, we need the discretized matrices corresponding to the operators <span>$\mathcal{D}^2$</span> and <span>$\mathcal{D}^4$</span>. Here, we do this using <a href="https://en.wikipedia.org/wiki/Chebyshev_nodes">Chebyshev nodes</a>.</p><pre><code class="language-julia hljs"># Çhebyshev discretization of differential operators
yF,DM = chebdif(N+2, 4);    
D2 = DM[2:N+1,2:N+1,2];              #D^2
yF,D4 = cheb4c(N+2);                 #D^4

# The base flow for Poiseuille plane flow
U   = 1 .-yF.^2;
Up  = -2*yF;
Upp = -2;

eye = Matrix{Float64}(I, N, N);  </code></pre><p>We can now set up the coefficient matrices and create a corresponding <a href="../types/#NonlinearEigenproblems.NEPTypes.PEP"><code>PEP</code></a> object.</p><pre><code class="language-julia hljs">A4 = [-eye/Re zeros(N,N);zeros(N,N) zeros(N,N)];
A3 = [-1im*diagm(0 =&gt; U) zeros(N,N);zeros(N,N) zeros(N,N)];
A2 = [(1im*ω-2β^2/Re)*eye+2D2/Re zeros(N,N);zeros(N,N) eye/Re];
A1 = [1im*(diagm(0 =&gt; U)*(D2-eye*β^2)-Upp*eye) zeros(N,N);zeros(N,N) 1im*diagm(0=&gt;U)];
A0 = [2β^2*D2/Re-D4/Re-β^4*eye/Re+1im*ω*(β^2*eye-D2) zeros(N,N);1im*β*diagm(0 =&gt; Up) (-1im*ω+β^2/Re)*eye-D2/Re];
nep = PEP([A0,A1,A2,A3,A4]); #Create a PEP object</code></pre><h2 id="Solving-with-NEP-PACK"><a class="docs-heading-anchor" href="#Solving-with-NEP-PACK">Solving with NEP-PACK</a><a id="Solving-with-NEP-PACK-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-with-NEP-PACK" title="Permalink"></a></h2><p>Because of poorly scaled coefficient matrices, direct application of NEP-PACK&#39;s solvers on this problem is inadequate. We note that the norm of the coefficient matrices are:</p><pre><code class="language-julia-repl hljs">julia&gt; norm.(get_Av(nep))
5-element Array{Float64,1}:
      8.37194982854379e13
 473949.06740743306      
 303285.4108872535       
      9.817076958035932  
      0.008</code></pre><p>Fortunally we can get around this issue by scaling the PEP with NEP-PACK&#39;s <code>shift_and_scale</code> , and solving the scaled problem <span>$T(\lambda) = M(100\lambda)$</span> instead.</p><pre><code class="language-julia hljs">sc=100;
nep1 = shift_and_scale(nep,scale=sc);
mult_scale = norm(nep1.A[end]);
nep2 = PEP(nep1.A ./ mult_scale);</code></pre><p>The scaled PEP has much better scaled coefficient matrices.</p><pre><code class="language-julia-repl hljs">julia&gt; norm.(get_Av(nep2))
5-element Array{Float64,1}:
    1.0464937285679738e8
   59.24363342592913    
 3791.0676360906696     
   12.271346197544913   
    1.0</code></pre><p>In this example, we are interested in computing several eigenvalues and our region of interest for the spectrum is in the first quadrant. We use the Tensor Infinite Arnoldi (TIAR) method implemented in <a href="../methods/#NonlinearEigenproblems.NEPSolver.tiar"><code>tiar</code></a>. The method is called twice with different shifts <code>σ</code>.</p><pre><code class="language-julia-repl hljs">λ1,v1 = tiar(nep2,σ=0.006,v=ones(size(nep,1)),neigs=10,maxit=200,tol=1e-14);
λ2,v2 = tiar(nep2,σ=0.005+0.005im,v=ones(size(nep,1)),neigs=10,maxit=200,tol=1e-14);
λtotal = [λ1;λ2];</code></pre><p>The computed eigenvalues are scaled back to get the eigenvalues of the original problem.</p><pre><code class="language-julia-repl hljs"> julia&gt; λ_orig = sc*λtotal
20-element Array{Complex{Float64},1}:
  0.3765784040323032 + 0.09959915134763689im
 0.30865495875240445 + 0.008960297181538185im
  0.4087137042139992 + 0.15906877547743775im
  0.9787481874161135 + 0.0443939782417711im  
  0.3430534698620533 + 0.049837687199345705im
 -0.2863097014631293 - 0.9011417554715162im  
  0.6116671743160434 + 0.14049254864376023im
 0.40933722321954447 + 0.15820580776369225im
 0.43950860634751715 + 0.22808195062035772im
 0.37687009160849716 + 0.09924325053688597im
 0.47944942696208637 + 0.40059913080096726im
  0.4934801111510124 + 0.520295324777746im   
   0.496596553706975 + 0.480303769976205im   
 0.49307795048742775 + 0.6085434637464817im  
  0.5095613980300516 + 0.6639488620533516im  
  0.4998069928360967 + 0.3870365082453997im  
  0.4861657916302239 + 0.45751028495939855im
  0.4766598864386299 + 0.5557787925858408im  
  0.4684227095574837 + 0.4353215518427161im  
  0.5014319544500476 + 0.5889845608687214im  </code></pre><p>The computed eigenvalues in the first quadrant can be plotted by:</p><pre><code class="language-julia-repl hljs">julia&gt; plot(real.(λ_orig),imag.(λ_orig),seriestype=:scatter,xaxis=[0.2,1.05],yaxis=[0,0.8])</code></pre><p>The resulting plot is:</p><br>
<img src="https://nep-pack.github.io/NonlinearEigenproblems.jl/eigvals.png" height=450><p>This is in agreement with Figure 7.2 from Schmid–Henningson for the eigenvalues in the first quadrant.</p><br>
<img src="https://nep-pack.github.io/NonlinearEigenproblems.jl/henningson.png" height=450></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial_linsolve/">« Tutorial 11 (Linear solvers)</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 28 June 2023 13:04">Wednesday 28 June 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
